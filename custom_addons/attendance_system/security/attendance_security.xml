<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <!-- Groups -->
        <record id="group_attendance_employee" model="res.groups">
            <field name="name">Attendance Employee</field>
            <field name="category_id" ref="base.module_category_human_resources"/>
        </record>zz

        <record id="group_attendance_department_manager" model="res.groups">
            <field name="name">Attendance Department Manager</field>
            <field name="category_id" ref="base.module_category_human_resources"/>
        </record>

        <record id="group_attendance_hr" model="res.groups">
            <field name="name">Attendance HR</field>
            <field name="category_id" ref="base.module_category_human_resources"/>
        </record>

        <!-- Record Rules for hr.attendance -->
        <!-- Employee: read only own records -->
        <record id="rule_attendance_employee_read_own" model="ir.rule">
            <field name="name">Attendance: Employee read own</field>
            <field name="model_id" ref="hr_attendance.model_hr_attendance"/>
            <field name="groups" eval="[(4, ref('attendance_system.group_attendance_employee'))]"/>
            <field name="domain_force">[("employee_id.user_id", "=", user.id)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Department Manager: read/write for employees in own department -->
        <record id="rule_attendance_department_manager" model="ir.rule">
            <field name="name">Attendance: Department manager</field>
            <field name="model_id" ref="hr_attendance.model_hr_attendance"/>
            <field name="groups" eval="[(4, ref('attendance_system.group_attendance_department_manager'))]"/>
            <field name="domain_force">[("employee_id.department_id.manager_id.user_id", "=", user.id)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- HR: full access to all attendances -->
        <record id="rule_attendance_hr_all" model="ir.rule">
            <field name="name">Attendance: HR full access</field>
            <field name="model_id" ref="hr_attendance.model_hr_attendance"/>
            <field name="groups" eval="[(4, ref('attendance_system.group_attendance_hr'))]"/>
            <field name="domain_force">[(1,'=',1)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Face data model: limit to HR via access rights; no extra rules here -->
    </data>
</odoo>


